{% extends 'cbtsystem/index.html' %}

{% block content %}

<div class="container">

    <h5 id="testName" class="text-center text-warning">SAT: </h5>
    <br>
    <div class="d-flex justify-content-start text-danger pe-4 mb-3">
        <h3>
            <span class="text-light" onclick="timerFunction()" style="cursor: pointer;">Reading Directions Page &nbsp;
            </span>

        </h3>
    </div>
    <div class="ms-3">
        <li>use local storage to start of break time</li>
        <li>use local storage to start of break time</li>
        <li>use local storage to start of break time</li>
        <li>use local storage to start of break time</li>
        <li>use local storage to start of break time</li>
        <li>use local storage to start of break time</li>
        <li>use local storage to start of break time</li>
        <li>use local storage to start of break time</li>
    </div>

    <div class="text-center py-5">

        <a href="{% url 'demo' %}" class="btn btn-secondary btn-lg d-none" id="startBtn">Start Section <i
                class="bi bi-arrow-right-circle"></i></a>
    </div>

    <hr>

    <div id="jsData"></div>


    <script>

var selectedTest = localStorage.getItem("selectedTest")
var selectedTestId = localStorage.getItem("selectedTestId")
        function myTest() {
  document.getElementById("testName").innerHTML = `SAT: ${selectedTest} - ${selectedTestId}`
}

myTest()




    </script>
    <script>
var apiList = [];
var studentApi = "";

const user_id = JSON.parse(document.getElementById("user_id").textContent);


function getPending() {
  fetch("http://127.0.0.1:8000/pendingapi")
    .then((resp) => resp.json())
    .then(function (data) {
      apiList = data;

      for (i in apiList) {
        if (apiList[i].studentId == user_id) {
          studentApi = apiList[i];
          break
        }
      }
    })
    .then(function () {
      console.log("studentApi", studentApi);

      document.getElementById("jsData").innerHTML =
       `Reading: ${studentApi.studentAnswersReading} <br> Writing: ${studentApi.studentAnswersWriting}
        <br>studentApi.testName:  ${studentApi.testName}`;



      if (studentApi.testId === selectedTestId) {

        localStorage.setItem("readingApi", studentApi.studentAnswersReading);
        localStorage.setItem("readingApiTime", studentApi.timeLeftReading);

        localStorage.setItem("writingApi", studentApi.studentAnswersWriting);
        localStorage.setItem("writingApiTime", studentApi.timeLeftWriting);

        document.getElementById("startBtn").classList.remove("d-none", "btn-secondary");
        document.getElementById("startBtn").classList.add("btn-outline-warning");


      } else {


        localStorage.removeItem("readingApi");
        localStorage.removeItem("readingApiTime");

        localStorage.removeItem("writingApi");
        localStorage.removeItem("writingApiTime");


              document.getElementById("startBtn").classList.remove("d-none");

      }


    });
}

getPending();


    </script>

</div>


{% endblock %}